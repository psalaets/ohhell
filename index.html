<!DOCTYPE html>
<html ng-app="ohhell">
    <head>
        <meta charset="utf-8">
        <title>Oh Hell</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <style type="text/css">
            .table td.success {
                background-color: #DFF0D8;
            }

            .table td.error {
                background-color: #F2DEDE;
            }

            #round-details {
                position: fixed;
                top: 60px;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div ng-view></div>
        </div>

        <script type="text/ng-template" id="landing.html">
            <div class="hero-unit">
                <h1>Oh Hell</h1>
                <p>Scorekeeper for a variation of <a href="http://en.wikipedia.org/wiki/Oh,_hell">Oh Hell</a></p>
                <p>
                    <input class="btn btn-primary btn-large" type="button" ng-click="setup()" value="New Game"/>
                    <input class="btn btn-large" type="button" ng-click="showSavedGames()" value="Resume ({{savedGameCount}})"/>
                </p>
            </div>
        </script>

        <script type="text/ng-template" id="setup.html">
            <form>
                <h1>Who is playing?</h1>
                <input ng-list ng-model="players" placeholder="1st dealer, 2nd dealer, etc" class="span6"/>

                <h1>Play up to...</h1>
                <select ng-model="maxRound" ng-options="i.toString() for i in 1 | upto:maxRoundAllowed" class="span1"></select>
            </form>

            <input class="btn btn-success" ng-hide="needMorePlayers" type="button" ng-click="startGame()" value="Start Game"/>
            <div class="alert alert-error" ng-show="needMorePlayers">
                <strong>Add more players</strong><br>
                {{message}}
            </div>

        </script>

        <script type="text/ng-template" id="savedGames.html">
            <h1>Games in Progress</h1>

            <div class="row" ng-show="!savedGames.length">
                <div class="well span6">
                    No games in progress
                </div>
            </div>
            <div class="row" ng-repeat="game in savedGames | orderBy:'-startTime'">
                <div class="well span6">
                    <h4>Started {{game.startTime | timeAgo}}</h4>
                    <p>with {{game.players | sentence}}</p>
                    <p>
                        <span ng-pluralize count="game.roundsLeft()" when="{
                            '1': '{} round remaining',
                            'other': '{} rounds remaining'
                        }"></span>
                        <input class="btn pull-right" type="button" ng-click="resume(game)" value="Resume"/>
                    </p>
                </div>
            </div>
        </script>

        <script type="text/ng-template" id="round.html">
            <div class="row">
                <div class="span12">
                    <h1>Round {{round.getName()}}</h1>
                </div>
            </div>
            <div class="row">
                <div class="span6">
                    <table class="table">
                        <tr>
                            <th>Player</th>
                            <th>Bid</th>
                            <th><input type="button" class="btn btn-success" value="Everyone Got It" ng-click="everyoneGotIt()"/></th>
                            <th>Points</th>
                        </tr>
                        <tr ng-repeat="score in round.getScores()">
                            <td>{{score.getPlayer()}}</td>
                            <td>
                                <select ng-model="score.bid" ng-options="i.toString() for i in 0 | upto:round.getMaxTricks()" class="span1"></select>
                            </td>
                            <td>
                                <input class="btn btn-success" type="button" value="Got It" ng-click="score.madeBid()"/>
                                <input class="btn btn-danger" type="button" value="Missed It" ng-click="score.missedBid()"/>
                            </td>
                            <td ng-class="{success: score.gotBid == true, error: score.gotBid == false}">{{score.getPoints() | sign}}</td>
                        </tr>
                    </table>

                    <input class="btn" type="button" value="Round Finished" ng-show="round.isFinished()" ng-click="roundFinished()"/>
                </div>
                <div class="span3">
                    <div id="round-details" class="well well-large">
                        <p>{{round.getDealer()}} is Dealer</p>
                        <p>
                            <span ng-pluralize count="round.getMaxTricks()" when="{
                                '1': '1 Trick Possible',
                                'other': '{} Tricks Possible'
                            }"></span>
                        </p>
                        <p>{{round.getTotalBids()}} Total Bids</p>
                    </div>
                </div>
            </div>
        </script>

        <script type="text/ng-template" id="scoreboard.html">
            <h1>Scoreboard</h1>

            <table class="table table-bordered">
                <tr>
                    <th>Rank</th>
                    <th>Player</th>
                    <th>Total</th>
                    <th ng-repeat="round in rounds">
                        {{round.getName()}}
                    </th>
                </tr>
                <tr ng-repeat="stat in stats | orderBy:rank">
                    <td>{{stat.rank | place}}</td>
                    <td>{{stat.player}}</td>
                    <td>{{stat.total}}</td>
                    <td ng-repeat="score in stat.scores" ng-class="{success: score.gotBid == true, error: score.gotBid == false}">
                        <span ng-show="score.isReported()">{{score.getBid()}}</span>
                    </td>
                </tr>
            </table>

            <input class="btn" type="button" value="Next Round" ng-show="hasNextRound()" ng-click="nextRound()"/>
            <input class="btn" type="button" value="Done" ng-hide="hasNextRound()" ng-click="done()"/>
        </script>

        <script src="js/vendor/angular.js"></script>
        <script src="js/vendor/lostorage.js"></script>
        <script src="js/vendor/vagueTime.js"></script>

        <script src="js/model.js"></script>
        <script src="js/controller.js"></script>
        <script src="js/service.js"></script>
        <script src="js/filter.js"></script>
        <script src="js/app.js"></script>
    </body>
</html>